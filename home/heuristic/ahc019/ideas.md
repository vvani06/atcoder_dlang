# AHC019

MC Digital プログラミングコンテスト2023（AtCoder Heuristic Contest 019）

問題文: https://atcoder.jp/contests/ahc019/tasks/ahc019_a


## 考えたこと

### スコア計算

- 2つの立体で「両方とも使う」ブロックを多くできると良い
- と同時に、ブロックの体積を大きくできると良い

ブロックの堆積は大きい方が良いが、あくまで共通で使える場合に限る。

### とりあえず体積1の組み合わせから始める

最初は全てのブロックを体積1として、配置できるすべての座標に置くことを考えると始めやすそう。
余計なブロックは後から取り除く形でなんとかできるのでは。

### DFSが使えそう

ある座標から「正面」「右・左」「上・下」に移動するようなDFSを考える。
2つの立体における任意の点・方向でスタートして、2つの立体で移動できる経路のうち最大のものをとっていく。

### 体積1の残留ブロックを消す

体積が大きいブロックの組み合わせが作れたとして、シルエットに影響のない体積1のブロックがあるなら
それは純粋に取り除くことをしてしまっても良いはず。 r1, r2 の削減になる


## Diary

### 20230318
今日からコンテスト開始。東京ではオンサイトコンテストをやっているらしくて盛り上がっている。
問題文を見た限り、これは難しそう・・！ということでそっ閉じしてスプラとポケモンをやった。

### 20230319
実装に取り掛かる。とりあえず体積1のブロックを並べるだけなら簡単だろう。
「置いてはいけない座標」はシルエットから明確に割り出せるので、それ以外の座標に置けるだけ置く方針で実装。
ついでに、2パターンで共有できるブロックのIDは最大まで共有するようにしておく。これで提出。

サンプルコードをそのまま提出している人がたくさんいるっぽくて、スコアが並んでいた。自分のスコアは一応それよりは高い模様。
基本方針はサンプルコードも同じなのだけど、サンプルコードではブロックの共通をしていない分で差がついているようだ。

スコアは 11.5T ほど。

### 20230320
労働してた。体調がほんのり悪かったので早く寝た。

### 20230321
DFSでマージしていくやつの実装を進めてみる。
静的配列を使い慣れてないせいか、実装が悪いのか手元の環境でやたらとセグメンテーション違反が出て困る。
手元のエラーはコードテストでは再現しないのでとりあえずできたものを提出してみる。

11.5T => 3.0T に改善。
実行時間は1.3sくらい。 O(D^^3 * D^^3) = 7,529,536 

スコアが改善することはわかったのでこの方針は続行。
再帰実装をやめてキューでやるようにしてとりあえず回避。

今は探索を始める際の始点を若い方からで固定しているのだけど、
ここをランダムスタートにすると良いケースが出てきそうな気がするなー。
あと、2つの形で「向きが違う」パターンはまだ考慮していないので、そこらへんか。
先に「向きが違う」を検討して、その後多点スタートを考慮するのが良いかな。

実装が楽だったので、とりあえず多点というか全点スタートを試してみた。
当然TLEになる実装だけど、スコア算出だけ参考地として出しておく。

2023/03/21 05:53:34	59406829554.27 (固定)
2023/03/21 11:34:17	58039169407.51 (全点)

全然スコアに影響しない。これはランダム要素を取り入れるにしても後で良さそうだな〜

